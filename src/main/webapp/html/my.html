

<html>
<head>
    <title>RPG</title>
    <script src=https://code.jquery.com/jquery-3.6.0.min.js></script>
    <link href="/css/my.css" rel="stylesheet">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>

    <script>

        function getPlayers(select) {
            $.ajax({
                type: "GET",
                url: "/rest/players/?pageNumber=0&pageSize=" + select,
                dataType: "json",
                success: function (response) {
                    $("#myTable td").remove();
                    table = document.getElementById('myTable');
                    if (response.length) {
                        for (i = 0, l = response.length; i < l; i++) {
                            const table = $('#myTable');
                            const tr = $('<tr>');
                            tr.append('<td>'+ response[i].id + '</td>');
                            tr.append('<td>'+ response[i].name + '</td>');
                            tr.append('<td>'+ response[i].title + '</td>');
                            tr.append('<td>'+ response[i].race + '</td>');
                            tr.append('<td>'+ response[i].profession + '</td>');
                            tr.append('<td>'+ response[i].level + '</td>');
                            tr.append('<td>'+ new Date(response[i].birthday).toLocaleDateString() + '</td>');
                            tr.append('<td>'+ response[i].banned + '</td>');
                            tr.append('<td>'+ '<img src="/img/edit.png">' + '</td>');
                            tr.append('<td>'+ '<img data-value='+ response[i].id + '  onclick=deleteAccount(this) src="/img/delete.png">' + '</td>');
                            tr.append("</tr>");
                            table.append(tr);
                        }
                    }
                }
            });
        }
        getPlayers(3);

        function calculatePageCount() {
            var selectVal = getSelectVal();
            var totalCount = getTotalCount();
            var pageCount = totalCount / selectVal;
            return pageCount;
        }


    function getTotalCount() {
        let value = 1;
        $.ajax({
            url: "/rest/players/count",
            async: false,
            success: function (result) {
                value = result;
            }
        });
        return parseInt(value);
    }

        function deleteAccount(btn) {
            $.ajax({
                url: "/rest/players/{id}",
                type: 'DELETE',
                success: function(result) {
                    for (let i = 0; i < result.length; i++) {
                        if (result[i].id === btn.id) {
                            result[i].delete();
                        }
                    }
                }
            });
            var row = btn.parentNode.parentNode;
            row.parentNode.removeChild(row);
        }
    </script>


</head>
<body>
<h1>RPG admin panel</h1>
<h2>Accounts list:</h2>

<form action="#">
    <label for="dropdown">Count per page: </label>
    <select name="menu" id="dropdown" onchange="getSelectValue();">
        <option value=3>3</option>
        <option value=10>10</option>
        <option value=15>15</option>
        <option value=20>20</option>
    </select>
<!--    <input type="submit" value="Submit" />-->
    <script>
        function getSelectValue() {
            var selectedValue = document.getElementById('dropdown').value;
            getPlayers(selectedValue);
        }
    </script>
</form>
<table id="myTable" border="1" class="display">
   <thead>
       <th>#</th>
       <th>Name</th>
       <th>Title</th>
       <th>Race</th>
       <th>Profession</th>
       <th>Level</th>
       <th>Birthday</th>
       <th>Banned</th>
       <th>Edit</th>
       <th>Delete</th>
   </thead>
</table>
<div class="pagination">
    <a href="#"> < </a>
    <a class="active" href="#">1</a>
    <a href="#">2</a>
    <a href="#">3</a>
    <a href="#">4</a>
    <a href="#">5</a>
    <a href="#">6</a>
    <a href="#"> > </a>
</div>
<h8>.</h8>
<hr>
<h2>Create new account:</h2>
<form>
    <label for="name">name:</label><br>
    <input type="text" id="name" name="name"><br>
    <label for="title">title:</label><br>
    <input type="text" id="title" name="title"><br>
    <label for="race">race:</label><br>
    <input list="race">
    <datalist id="race">
        <option value="HUMAN">
        <option value="DWARF">
        <option value="ELF">
        <option value="GIANT">
        <option value="ORC">
        <option value="TROLL">
        <option value="HOBBIT">
    </datalist><br><br>
    <label for="profession">profession:</label><br>
    <input list="profession">
    <datalist id="profession">
        <option value="WARRIOR">
        <option value="ROGUE">
        <option value="SORCERER">
        <option value="CLERIC">
        <option value="PALADIN">
        <option value="NAZGUL">
        <option value="WARLOCK">
        <option value="DRUID">
    </datalist><br><br>
    <label for="level">level (between 0 and 100):</label><br>
    <input type="number" id="level" name="level"  min="0" max="100"><br>
    <label for="date">Birthday :</label>
    <input type="date" id="date" name="date"><br><br>
    <input list="banned">
    <datalist id="banned">
        <option value="true">
        <option value="false">
    </datalist><br>

    <input type="submit" value="Submit">
</form>
</body>
</html>